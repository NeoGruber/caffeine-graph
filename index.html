<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caffeine Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>‚òï Caffeine Tracker</h1>
        
        <div class="accordion">
            <div class="accordion-header" onclick="toggleAccordion('settingsAccordion')">
                <h2>‚öôÔ∏è Personal Settings</h2>
                <span class="accordion-icon" id="settingsAccordionIcon">‚ñº</span>
            </div>
            <div class="accordion-content open" id="settingsAccordion">
                <div class="accordion-body">
                    <div class="form-group">
                        <label for="personaSelect">Select Profile</label>
                        <select id="personaSelect" onchange="loadPersona()">
                            <option value="custom">Custom</option>
                            <option value="adult-male-average">Average Adult Male (70kg, 175cm)</option>
                            <option value="adult-female-average">Average Adult Female (60kg, 165cm)</option>
                            <option value="adult-male-large">Large Adult Male (90kg, 185cm)</option>
                            <option value="adult-female-large">Large Adult Female (75kg, 175cm)</option>
                            <option value="adult-male-small">Small Adult Male (60kg, 165cm)</option>
                            <option value="adult-female-small">Small Adult Female (50kg, 155cm)</option>
                            <option value="athlete-male">Male Athlete (80kg, 180cm)</option>
                            <option value="athlete-female">Female Athlete (65kg, 170cm)</option>
                            <option value="senior-male">Senior Male (75kg, 172cm)</option>
                            <option value="senior-female">Senior Female (65kg, 160cm)</option>
                        </select>
                    </div>
                    <div id="customSettings">
                        <div class="settings-grid">
                            <div class="form-group">
                                <label for="gender">Gender</label>
                                <select id="gender">
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="weight">Weight (kg)</label>
                                <input type="number" id="weight" value="70" min="30" max="200" step="1">
                            </div>
                            <div class="form-group">
                                <label for="age">Age (years)</label>
                                <input type="number" id="age" value="30" min="1" max="120" step="1">
                            </div>
                            <div class="form-group">
                                <label for="height">Height (cm)</label>
                                <input type="number" id="height" value="170" min="100" max="250" step="1">
                            </div>
                        </div>
                    </div>
                    <div class="time-range-grid">
                        <div class="form-group">
                            <label for="wakeTime">Wake Up Time</label>
                            <select id="wakeTime"></select>
                        </div>
                        <div class="form-group">
                            <label for="sleepTime">Sleep Time</label>
                            <select id="sleepTime"></select>
                        </div>
                    </div>
                    <button onclick="updateSettings()">Update Settings</button>
                </div>
            </div>
        </div>
        
        <div class="input-section">
            <h2>Add Caffeine Consumption</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="sourceSelect">Caffeine Source</label>
                    <select id="sourceSelect"></select>
                </div>
                <div class="form-group">
                    <label for="quantity">Quantity</label>
                    <input type="number" id="quantity" value="1" min="0.1" step="0.1">
                </div>
                <div class="form-group">
                    <label for="time">Time</label>
                    <select id="time"></select>
                </div>
            </div>
            <button onclick="addConsumption()">Add to Tracker</button>
            
            <div class="consumption-list" id="consumptionList">
                <h2>Today's Consumptions</h2>
            </div>
        </div>

        <canvas id="caffeineChart"></canvas>
        
        <div class="legend">
            <strong>Reference Levels:</strong>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgb(255, 193, 7);"></div>
                <span>Sleep Impact Level (<span id="sleepLevelText">100mg</span>) - Caffeine above this level 4 hours before bed may disrupt sleep</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgb(244, 67, 54);"></div>
                <span>Health Critical Level (<span id="criticalLevelText">400mg</span>) - Maximum recommended daily intake</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgb(156, 39, 176);"></div>
                <span>Sleep Cutoff Line (Purple) - 4 hours before your bedtime; aim to be below 100mg by this time</span>
            </div>
        </div>
        
        <div class="disclaimer">
            <h3>‚ö†Ô∏è Important Medical Disclaimer</h3>
            <p><strong>This tool is for educational and informational purposes only.</strong> The caffeine calculations and recommendations are based on general health guidelines and population averages. They are not personalized medical advice and may not be appropriate for your individual health situation.</p>
            
            <p><strong>Individual responses to caffeine vary significantly based on:</strong></p>
            <ul>
                <li>Genetics (some people metabolize caffeine 40x faster than others)</li>
                <li>Medications that interact with caffeine</li>
                <li>Pre-existing health conditions (heart conditions, anxiety disorders, etc.)</li>
                <li>Pregnancy or breastfeeding status</li>
                <li>Tolerance built up from regular consumption</li>
            </ul>
            
            <p><strong>Consult a healthcare provider if you experience:</strong></p>
            <ul>
                <li><strong>Sleep problems:</strong> Difficulty falling asleep, frequent waking, or poor sleep quality</li>
                <li><strong>Anxiety symptoms:</strong> Jitteriness, nervousness, rapid heartbeat, or panic attacks</li>
                <li><strong>Digestive issues:</strong> Stomach upset, acid reflux, or diarrhea</li>
                <li><strong>Headaches:</strong> Frequent headaches or migraines, especially when reducing caffeine</li>
                <li><strong>Heart palpitations:</strong> Irregular heartbeat or chest discomfort</li>
                <li><strong>High blood pressure:</strong> Caffeine can temporarily raise blood pressure</li>
                <li><strong>Dependency symptoms:</strong> Severe withdrawal symptoms like intense headaches, fatigue, or mood changes</li>
            </ul>
            
            <p><strong>Learn more about caffeine and health:</strong></p>
            <ul>
                <li><a href="https://www.fda.gov/consumers/consumer-updates/spilling-beans-how-much-caffeine-too-much" target="_blank">FDA: How Much Caffeine is Too Much?</a></li>
                <li><a href="https://www.mayoclinic.org/healthy-lifestyle/nutrition-and-healthy-eating/in-depth/caffeine/art-20045678" target="_blank">Mayo Clinic: Caffeine Content and Health Effects</a></li>
                <li><a href="https://www.hsph.harvard.edu/nutritionsource/caffeine/" target="_blank">Harvard T.H. Chan School of Public Health: Caffeine</a></li>
                <li><a href="https://www.sleepfoundation.org/nutrition/caffeine-and-sleep" target="_blank">Sleep Foundation: Caffeine and Sleep</a></li>
            </ul>
        </div>
        
        <div class="accordion">
            <div class="accordion-header" onclick="toggleAccordion('infoAccordion')">
                <h2>üìö About Caffeine Metabolism</h2>
                <span class="accordion-icon" id="infoAccordionIcon">‚ñº</span>
            </div>
            <div class="accordion-content" id="infoAccordion">
                <div class="accordion-body">
                    <p><strong>Caffeine Half-Life:</strong> Caffeine has a half-life of approximately 5 hours in healthy adults. This means that after 5 hours, half of the caffeine you consumed is still in your system. After 10 hours, you'll still have about 25% remaining.</p>
                    
                    <p><strong>How This Tool Works:</strong> The chart shows how caffeine accumulates and decays throughout the day based on your consumption pattern. Each time you consume caffeine, it adds to your bloodstream, and then gradually decreases following the exponential decay pattern.</p>
                    
                    <p><strong>Personalized Limits:</strong> Your maximum daily caffeine limit is calculated using the following formula:</p>
                    <ul>
                        <li>Base calculation: Weight (kg) √ó 6mg</li>
                        <li>Gender adjustment: Females receive 10% lower limit (research shows different metabolism rates)</li>
                        <li>Age adjustment: Seniors (65+) receive 15% lower limit (metabolism slows with age)</li>
                        <li>Maximum cap: 400mg per day (FDA recommended limit for healthy adults)</li>
                    </ul>
                    
                    <p><strong>Sleep Impact Level (100mg):</strong> Research shows that 100mg of caffeine can be safely consumed up to 4 hours before bedtime without disrupting sleep. However, caffeine consumed 6 hours or more before bed can still reduce total sleep time by over an hour, even if you don't notice it. The general recommendation is to stop caffeine consumption 8-9 hours before bedtime for optimal sleep quality.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>